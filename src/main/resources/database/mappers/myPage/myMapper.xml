<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
    <mapper namespace="com.starbucks.sw4.my.MyDAO">
    	
    	
    	
    	<update id="setCardNum" parameterType="OrderDTO">
    		update starHistory set cardNum = #{cardNum} where id=#{id}
    	</update>
    	
    	<update id="setMemberCard" parameterType="OrderDTO">
    		update membercard set menuCode=#{menuCode}, cardnum=#{cardNum}, korName=#{korName}, menuimage=#{menuImage}, balance=#{totalPrice}, memberNum=#{memberNum} where id =#{id}
    	</update>
    	
    	<select id="getMenu" parameterType="OrderDTO" resultType="OrderDTO">
    		select menuCode, korName, menuImage from menu where menuCode = #{menuCode}
    	</select>
    	
    	<select id="getOrder" parameterType="PayDTO" resultType="OrderDTO">
    		select * from menuorder where orderNum= 2
    	</select>
    
    	<insert id="setVocList" parameterType="MyDTO">
    		insert into customerqna values (qna_seq.nextval, #{category}, #{id}, #{storeName}, #{visitDate}, #{title}, #{contents}, #{storecode})
    	</insert>
    
    	<select id="getStore" parameterType="MyDTO" resultType="MyDTO">
    		select storeName, addr, storecode from store where storeName =#{storeName}
    	</select>
    	
    	<delete id="setMyInfoOut" parameterType="MyDTO">
    		delete from member where id=#{id}
    	</delete>
    
    	<select id="getMyIndex" resultType="MyDTO" parameterType="MemberDTO">
			select S.useStar, S.id, M.nickName, M.grade, C.menuimage, C.balance, C.korname
			from starHistory S join member M 
			on S.id = M.id
            full join membercard C 
            on S.id = C.id
			where M.id = #{id}
    	</select>
    	
    	<select id="getOne" parameterType="MemberDTO" resultType="MyDTO">
    		select * from member where id = #{id}
    	</select>
 
 		<update id="setUpdate" parameterType="MyDTO"> 
 			update member set phone=#{phone}, email=#{email}, nickname=#{nickName} where id=#{id}
	 	</update>
	 	
	 	<update id="setNewPw" parameterType="MyDTO"> 
 			update member set pw=#{pw} where id=#{id}
	 	</update>
    
    	<select id="getMyStar" parameterType="MyDTO" resultType="MyDTO">
    		select * from starhistory where id = #{id}
    	</select>
    	
    	<select id="getMyStore" parameterType="MyDTO" resultType="MyDTO">
    		select rownum R, N.* from (select * from memberStore where id= #{id})N
    		
    	</select>
    	
    	<insert id="setMemberJoinCard" parameterType="MemberDTO">
    		insert into membercard values (card_seq.nextval, #{id}, null, null, null, null, null, null, #{num})
    	</insert>
    	
    	<insert id="setMemberJoinStar" parameterType="MemberDTO">
    		insert into starhistory values (star_seq.nextval, #{id}, null, 0, 0, 0, null, null, 0, sysdate, sysdate)
    	</insert>
    </mapper>
